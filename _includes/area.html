{%- comment -%}
Render a single research "area" as a card (image on the left),
and list selected publications where the title itself is the link.

Usage:
  {% include area-card.html area=area_obj %}
  {% include area-card.html lookup="Offline Reinforcement Learning" %}
{%- endcomment -%}

{%- assign area_obj = nil -%}
{%- if include.area -%}
  {%- assign area_obj = include.area -%}
{%- elsif include.lookup -%}
  {%- assign area_obj = site.data.areas
      | where_exp: "a", "a.title contains include.lookup"
      | first -%}
{%- endif -%}

{%- assign area = area_obj | default: include -%}
{%- assign a_title = area.title | default: "[no title]" -%}
{%- assign a_desc  = area.description -%}
{%- assign a_img   = area.image -%}
{%- assign a_tags  = area.tags -%}
{%- assign pubs    = area.selected_publications -%}

<article class="area" id="{{ a_title | slugify }}">
  <!-- Left image panel -->
  <div class="area-image">
    <img
      src="{{ a_img | default: '/assets/images/citation-placeholder.svg' | relative_url class="area-title">{{ a_title }}</h3>

    {%- if a_desc -%}
      <p class="area-description">{{ a_desc }}</p>
    {%- endif -%}

    {%- if pubs and pubs.size > 0 -%}
      <details class="area-publications">
        <summary>Selected publications ({{ pubs.size }})</summary>
        <ul class="area-publist">
          {%- for p in pubs -%}
            {%- assign p_title = p.title | default: "[untitled]" -%}
            {%- assign p_link  = p.link  | default: nil -%}
            <li>
              {%- if p_link -%}
                <{ p_link | escape }}
                  <span class="area-pubtitle">{{ p_title }}</span>
                </a>
              {%- else -%}
                <span class="area-pubtitle">{{ p_title }}</span>
              {%- endif -%}
            </li>
          {%- endfor -%}
        </ul>
      </details>
    {%- endif -%}

    {%- if a_tags and a_tags.size > 0 -%}
      <div class="tags">
        {%- for t in a_tags -%}
          <span class="tag">{{ t }}</span>
        {%- endfor -%}
      </div>
    {%- endif -%}
  </div>
</article>
